# rules_fixes.yaml
# Liste de règles → suggestion de correctif (simulation "auto-fix")

rules:
  - rule_id: "R001"
    title: "Exposed secret in logs"
    severity: "critical"
    description: "Token / secret détecté dans les logs."
    suggestion:
      summary: "Mask secrets + use Vault"
      yaml_patch: |
        # Example GitHub Actions patch
        # - Add secret masking and use GitHub Secrets / Vault
        - name: Mask secrets
          run: |
            echo "::add-mask::${{ secrets.MY_TOKEN }}"
        - name: Use Vault (example)
          run: |
            echo "Fetch secrets from Vault here"

  - rule_id: "R002"
    title: "Pipeline contains error keywords"
    severity: "medium"
    description: "Le mot ERROR est détecté dans les logs."
    suggestion:
      summary: "Fail fast + improve step error handling"
      yaml_patch: |
        - name: Fail fast on errors
          run: |
            set -e
            echo "Stop pipeline if an error occurs"
